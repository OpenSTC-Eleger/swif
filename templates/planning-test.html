<div class="page-header" style="margin-top: 5px">
	<h1 style="margin: 0;"><%= lang.viewsTitles.planning %></h1>
</div>


	<div class="row-fluid">

		<!-- Interventions List -->
		<div class="span4">

			<!-- Table toolbar -->
			<div style="margin-bottom: 35px; height: 120px;">
				<a href="#modalAddInter" class="btn btn-primary" data-toggle="modal"><i class="icon-plus-sign"></i> <%= _.capitalize(lang.actions.addIntervention) %></a>	

			</div>
			<!-- Table toolbar -->


			<% if( _.size(interventions) > 0 ) { %>
			<aside class="accordion" id="accordionInter" style="overflow-y: scroll; max-height: 590px; margin-bottom: 0;">
				
				<% _.each(interventions, function (inter, i) { %>
				<div class="accordion-group">
					
					<div class="accordion-heading">
						<a class="accordion-toggle no-outline" data-toggle="collapse" data-parent="#accordionInter" href="#collapse_<%= inter.id %>">
							<i class="icon-pushpin"></i>&nbsp; <strong><%= inter.name %></strong>
							<% if(inter.planned_hours != false){ %>
								<span class="badge badge-info pull-right"><%= inter.planned_hours %>h</span>
							<% } %>
						</a>
						
						<p class="intervention-actions invisible">
							<a href="#"><i class="icon-pencil"></i>&nbsp;<%= _.capitalize(lang.actions.update) %></a> |
							<a href="#modalDeleteInter" class="modalDeleteInter" data-toggle="modal"><i class="icon-remove"></i>&nbsp;<%= _.capitalize(lang.actions.delete) %></a>
						</p>
					</div>

					<div id="collapse_<%= inter.id %>" class="accordion-body collapse">
						<div class="accordion-inner">
							<ul class="unstyled tasks">
								<!-- Loop Each Tasks -->
								<% 
									var allPlanned = true;

									_.each(inter.tasks, function (task, i) { %>
									
										<!-- Check if the Task is planned or not -->
										<% if(task.date_start != ""){ %>
											<li id="task_<%= task.id %>" class="external-event disabled">
												<i class="icon-time"></i>&nbsp;
												<span class="<%= (task.progress == '100' ? 'isCheck' : '') %>"><%= task.name %></span>&nbsp;
												<small class="pull-right"><%= task.planned_hours %>h</small>
										<% 
											
										} else{ %>
											<li id="task_<%= task.id %>" class="external-event">&nbsp;
												<strong><%= task.name %></strong>
												<small class="badge pull-right"><%= task.planned_hours %>h</small>
										<% 										
											allPlanned = false;
										}  %>

											<p class="task-actions invisible">
												<a href="#"><i class="icon-pencil"></i>&nbsp;<%= _.capitalize(lang.actions.update) %></a> |
												<a href="#modalDeleteTask" class="modalDeleteTask" data-toggle="modal"><i class="icon-remove"></i>&nbsp;<%= _.capitalize(lang.actions.delete) %></a>
											</p>

									<% });  %>
							</ul>

							<div class="div-actions">
								<button class="btn btn-primary btn-small no-outline addTaskPlanning" id="<%= inter.id %>" rel="tooltip" data-original-title="<%= _.capitalize(lang.actions.addTask) %>" data-placement="right">
									<i class="icon-plus"></i>
								</button>

								<button 
									class="btn btn-success btn-small pull-right no-outline" rel="tooltip" 
										data-original-title="<%= _.capitalize(lang.actions.enclosePlanning) %>" 
										data-placement="left" 
										<%= (allPlanned && (inter.state == app.Models.Intervention.state[0].value) && _.size(inter.tasks) > 0) ? "" : 'disabled' %>>
									<i class="icon-check"></i>
								</button>
							</div>
						</div>
					</div>
				</div>
				<% }) %>

			</aside>
			<% }else { %>
				<!-- No request in the Database -->
				<div class="alert alert-info">
					<i class="icon-info-sign icon-large"></i> &nbsp;<%= lang.infoMessages.noRequest %>.
				</div>
			<% } %>

		</div>
		<!-- /Interventions List -->


		
		<div class="span8">

			<!-- List Agents -->
			<div id="listAgentsTeams" class="tabbable tabs-left">
				<ul class="nav nav-tabs">
					<li class="active"><a href="#" data-target="#tab-agents" data-toggle="tab"><%= _.capitalize(lang.agents) %> &nbsp;&nbsp;<span class="badge"><%= _.size(officers) %></span></a></li>
					<li><a href="#" data-target="#tab-teams" data-toggle="tab"><%= _.capitalize(lang.teams) %></a></li>
					<li><a href="#" data-target="#tab-custom-teams" data-toggle="tab">Custom</a></li>
				</ul>
				<div class="tab-content">
					<div class="tab-pane active" id="tab-agents">
						<ul id="listAgents" class="unstyled inline nav nav-list">
							<%_.each(officers, function (officer, i) { %>
								<li><a href="#<%= _.slugify(officer.firstname)%>-<%= _.slugify(officer.name)%>"><i class="icon-user"></i><%= officer.firstname %> &nbsp;<%= officer.name %></a></li>
							<% }) %>
						</ul>
					</div>
					<div class="tab-pane" id="tab-teams">
						<p>Teams</p>
					</div>
					<div class="tab-pane" id="tab-custom-teams">
						<p>Custom</p>
					</div>
			  	</div>
			</div>
			<!-- /List Agents -->

			<!-- Calendar -->
			<div style="overflow: hidden; max-height: 590px;">
				<% _.each(officers, function (officer, i) { %>
					<section id="<%= _.slugify(officer.firstname)%>-<%= _.slugify(officer.name)%>" class="calendarContainer">
						<div id="officer_<%= officer.id %>" class="calendar thumbnail" 
						 	data-username="<%= officer.firstname %> &nbsp;<%= officer.name %>">
						</div>
					</section>
				<% }) %>
			</div>
			<!-- /Calendar -->
			
		</div>

	</div>



<!-- Modal Form Delete Intervention -->
<div id="modalDeleteInter" class="modal hide fade">
	<div class="modal-header">
	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	    <h3>Suppression de l'intervention</h3>
	</div>
	
	<div class="modal-body">

		<blockquote id="infoModalDeleteInter" class="spaceBottom">
			<p></p>
			<small></small>
		</blockquote>

		<p>Etes-vous sûr de vouloir supprimer cette intervention ?</p>
	</div>
	
	<div class="modal-footer">
	    <button type="button" class="btn btn-danger btnDeleteInter">Supprimer</button>&nbsp;&nbsp;
	    <a href="#" data-dismiss="modal">Annuler</a>
	</div>
</div>

<!-- Modal Form Delete Task -->
<div id="modalDeleteTask" class="modal hide fade">
	<div class="modal-header">
	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	    <h3>Suppression de la tâche</h3>
	</div>
	
	<div class="modal-body">

		<blockquote id="infoModalDeleteTask" class="spaceBottom">
			<p></p>
			<small></small>
		</blockquote>

		<p>Etes-vous sûr de vouloir supprimer cette tâche ?</p>
	</div>
	
	<div class="modal-footer">
	    <button type="button" class="btn btn-danger btnDeleteTask">Supprimer</button>&nbsp;&nbsp;
	    <a href="#" data-dismiss="modal">Annuler</a>
	</div>
</div>



<!-- Form to add a new Task -->
<div id="modalAddTask" class="modal hide fade">
	<div class="modal-header">
	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	    <h3>Nouvelle tâche</h3>
	</div>
	
	<div class="modal-body">
	    <form id="formAddTask" action="#" class="form-horizontal">
	    
			<!-- Task name -->
            <div class="control-group">
                <label for="taskName" class="control-label">Nom:</label>

                <div class="controls">
                    <input type="text" id="taskName" name="taskName" required="required"/>
                    <span class="help-inline"></span>
                </div>
            </div>

            <!-- Task Category -->
            <div class="control-group">
                <label for="taskCategory" class="control-label">Catégorie:</label>

                <div class="controls">
                     <select id="taskCategory"></select>
                    <span class="help-inline"></span>
                </div>
            </div>

			<!-- Task hour -->
            <div class="control-group">
                <label for="taskHour" class="control-label">Heures prévisionnelles:</label>

                <div class="controls">
                     <input type="number" id="taskHour" name="taskHour" required="required"/>
                    <span class="help-inline"></span>
                </div>
            </div>

	    </form>
	</div>
	
	<div class="modal-footer">
	    <button type="submit" class="btn btn-primary saveTaskPlanning">Enregistrer</button>&nbsp;&nbsp;
	    <a href="#" data-dismiss="modal">Annuler</a>
	</div>
</div>