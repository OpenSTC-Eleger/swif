<div class="container-fluid" data-spy="scroll" data-target="#listAgents" >
	
	<div class="page-header">
		<h1><%= lang.viewsTitles.planning %></h1>
	</div>


	<div class="row-fluid">

		<!-- Interventions List -->
		<div class="span3">
			<% if( _.size(interventions) > 0 ) {%>
			<aside class="accordion" id="accordionInter" data-spy="affix">
				
				<% _.each(interventions, function (inter, i) { %>
				<div class="accordion-group">
					
					<div class="accordion-heading">
						<a class="accordion-toggle no-outline" data-toggle="collapse" data-parent="#accordionInter" href="#collapse_<%= inter.id %>">
							<i class="icon-pushpin"></i>&nbsp; <strong><%= inter.name %></strong>
							<% if(inter.planned_hours != false){ %>
								<span class="badge badge-info pull-right"><%= inter.planned_hours %>h</span>
							<% } %>
						</a>
						
						<p class="intervention-actions invisible">
							<a href="#"><i class="icon-pencil"></i>&nbsp;<%= _.capitalize(lang.actions.update) %></a> |
							<a href="#modalDeleteInter" class="modalDeleteInter" data-toggle="modal"><i class="icon-remove"></i>&nbsp;<%= _.capitalize(lang.actions.delete) %></a>
						</p>
					</div>

					<div id="collapse_<%= inter.id %>" class="accordion-body collapse">
						<div class="accordion-inner">
							<ul class="unstyled tasks">
								<!-- Loop Each Tasks -->
								<% 
									var allPlanned = true;

									_.each(inter.tasks, function (task, i) { %>
									
										<!-- Check if the Task is planned or not -->
										<% if(task.date_start != ""){ %>
											<li id="task_<%= task.id %>" class="external-event disabled">
												<i class="icon-time"></i>&nbsp;
												<span class="<%= (task.progress == '100' ? 'isCheck' : '') %>"><%= task.name %></span>&nbsp;
												<small class="pull-right"><%= task.planned_hours %>h</small>
										<% 
											
										} else{ %>
											<li id="task_<%= task.id %>" class="external-event">&nbsp;
												<strong><%= task.name %></strong>
												<small class="badge pull-right"><%= task.planned_hours %>h</small>
										<% 										
											allPlanned = false;
										}  %>

											<p class="task-actions invisible">
												<a href="#"><i class="icon-pencil"></i>&nbsp;<%= _.capitalize(lang.actions.update) %></a> |
												<a href="#modalDeleteTask" class="modalDeleteTask" data-toggle="modal"><i class="icon-remove"></i>&nbsp;<%= _.capitalize(lang.actions.delete) %></a>
											</p>

									<% });  %>
							</ul>

							<div class="div-actions">
								<button class="btn btn-primary btn-small no-outline addTaskPlanning" id="<%= inter.id %>" rel="tooltip" data-original-title="<%= _.capitalize(lang.actions.addTask) %>" data-placement="right">
									<i class="icon-plus"></i>
								</button>

								<button 
									class="btn btn-success btn-small pull-right no-outline" rel="tooltip" 
										data-original-title="<%= _.capitalize(lang.actions.enclosePlanning) %>" 
										data-placement="left" 
										<%= (allPlanned && (inter.state != app.Models.Intervention.state[1].value) && _.size(inter.tasks) > 0) ? "" : 'disabled' %>>
									<i class="icon-check"></i>
								</button>
							</div>
						</div>
					</div>
				</div>
				<% }) %>

			</aside>
			<% }else { %>
				<!-- No request in the Database -->
				<div class="alert alert-info">
					<i class="icon-info-sign icon-large"></i> &nbsp;<%= lang.infoMessages.noRequest %>.
				</div>
			<% } %>

		</div>
		<!-- /Interventions List -->


		<!-- Calendar -->
		<div class="span7">
			<% _.each(officers, function (officer, i) { %>
				<section id="<%= _.slugify(officer.firstname)%>-<%= _.slugify(officer.name)%>" class="calendarContainer">
					<div id="officer_<%= officer.id %>" class="calendar thumbnail" data-username="<%= officer.firstname %> &nbsp;<%= officer.name %>"></div>

				</section>
			<% }) %>
			

		</div>
		<!-- /Calendar -->


		<!-- List Agents -->
		<div class="span2 navListAgents">
			<ul class="nav nav-list well well-small" id="listAgents" data-spy="affix" data-offset-top="20">
			  	<li class="nav-header">
			  		<h4><i class="icon-group icon-large"></i>&nbsp;&nbsp;&nbsp;&nbsp;Agents&nbsp;&nbsp;<span class="badge pull-right"><%= _.size(officers) %></span></h4></li>
				<li class="divider"></li>
				
				<%_.each(officers, function (officer, i) { %>
					<li><a href="#<%= _.slugify(officer.firstname)%>-<%= _.slugify(officer.name)%>"><i class="icon-caret-right"></i><%= officer.firstname %> &nbsp;<%= officer.name %></a></li>
				<% }) %>	
			</ul>
		</div>
		<!-- /List Agents -->

	</div>

</div>




<!-- Modal Form Delete Intervention -->
<div id="modalDeleteInter" class="modal hide fade">
	<div class="modal-header">
	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	    <h3>Suppression de l'intervention</h3>
	</div>
	
	<div class="modal-body">

		<blockquote id="infoModalDeleteInter" class="spaceBottom">
			<p></p>
			<small></small>
		</blockquote>

		<p>Etes-vous sûr de vouloir supprimer cette intervention ?</p>
	</div>
	
	<div class="modal-footer">
	    <button type="button" class="btn btn-danger btnDeleteInter">Supprimer</button>&nbsp;&nbsp;
	    <a href="#" data-dismiss="modal">Annuler</a>
	</div>
</div>

<!-- Modal Form Delete Task -->
<div id="modalDeleteTask" class="modal hide fade">
	<div class="modal-header">
	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	    <h3>Suppression de la tâche</h3>
	</div>
	
	<div class="modal-body">

		<blockquote id="infoModalDeleteTask" class="spaceBottom">
			<p></p>
			<small></small>
		</blockquote>

		<p>Etes-vous sûr de vouloir supprimer cette tâche ?</p>
	</div>
	
	<div class="modal-footer">
	    <button type="button" class="btn btn-danger btnDeleteTask">Supprimer</button>&nbsp;&nbsp;
	    <a href="#" data-dismiss="modal">Annuler</a>
	</div>
</div>



<!-- Form to add a new Task -->
<div id="modalAddTask" class="modal hide fade">
	<div class="modal-header">
	    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	    <h3>Nouvelle tâche</h3>
	</div>
	
	<div class="modal-body">
	    <form id="formAddTask" action="#" class="form-horizontal">
	    
			<!-- Task name -->
            <div class="control-group">
                <label for="taskName" class="control-label">Nom:</label>

                <div class="controls">
                    <input type="text" id="taskName" name="taskName" required="required"/>
                    <span class="help-inline"></span>
                </div>
            </div>

            <!-- Task Category -->
            <div class="control-group">
                <label for="taskCategory" class="control-label">Catégorie:</label>

                <div class="controls">
                     <select id="taskCategory"></select>
                    <span class="help-inline"></span>
                </div>
            </div>

			<!-- Task hour -->
            <div class="control-group">
                <label for="taskHour" class="control-label">Heures prévisionnelles:</label>

                <div class="controls">
                     <input type="number" id="taskHour" name="taskHour" required="required"/>
                    <span class="help-inline"></span>
                </div>
            </div>

	    </form>
	</div>
	
	<div class="modal-footer">
	    <button type="submit" class="btn btn-primary saveTaskPlanning">Enregistrer</button>&nbsp;&nbsp;
	    <a href="#" data-dismiss="modal">Annuler</a>
	</div>
</div>