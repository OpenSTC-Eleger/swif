<td><%= booking.id %></td>
<td>
	<a 	href="#collapse_<%= booking.getId() %>"
		class="accordion-object"
		data-toggle="popover"
		data-html="true"
		data-original-title="<%= _.capitalize(lang.about) %>"
		data-delay="160"
		data-content="">
			<i class="fa fa-thumb-tack">&nbsp;&nbsp;</i><%= _.capitalize(_(booking.getName()).escapeHTML()) %>
	</a>
	<!-- Interventions action -->
	<p class="row-actions invisible">
		<% if ( !_.isUndefined(booking.getRecurrence('id')) ) { %>
			<a href="#" class="displayOccurences" data-toggle="tooltip" data-original-title="Afficher les occurences" data-action="reccurent">
				<i class="fa fa-th-list fa-lg" data-action="reccurent">&nbsp;</i>
			</a>
		<% } %>

		<% if(booking.hasActions("cancel")) { %>
			 &nbsp;<a href="#" class="buttonCancelInter" data-toggle="modal"><i class="fa fa-ban fa-lg" data-toggle="tooltip" data-original-title="<%= _.capitalize(lang.actions.cancel) %>"></i></a> 
		<% } %>
	</p>
</td>
<td>
<span data-toggle="tooltip" data-original-title="<%= booking.getResourceQuantities() %>"> <%= booking.getResourceNames('string') %></span>
</td>
<td><%= booking.getStartDate('human') %></td>
<td><%= booking.getEndDate('human') %></td>
<td>
	<span 
		data-toggle="tooltip" 
		data-html="true" 
		data-original-title="<strong><%= booking.fromCitizen() ? lang.citizen : booking.getClaimerType() %></strong> <%= booking.getClaimerContact() %>">
			<%= booking.fromCitizen() ? booking.getCitizenName() : booking.getClaimer() %>
	</span>
</td>
<td>
<span data-toggle="tooltip" data-original-title="<%= booking.getCreateDate('fromNow') %>"> <%= booking.getCreateDate() %></span>
</td>
<!-- Check the state of the booking -->
<td>
	<span 
		class="label label-<%= BookingModel.status[booking.getState()].color %>" 
		data-toggle="tooltip"
		data-original-title="<%= booking.getInformations() %>">
		<%= BookingModel.status[booking.getState()].translation %>
	</span>
</td>
<td>
	<!-- Check if the user can make action on the request -->
	<% if(!_.isEmpty(booking.getActions())){ 
		var actions = booking.getActions();
	%>
		<!-- Create the buttons group action -->
		<div class="btn-group btn-group-sm">
	
			<!-- Check if the booking is not in waiting state -->
			<%
	
				var mainAction = '';
				var mainActionColor = '';
				var mainActionIcon = '';
				var mainActionDisabled = '';
		
				switch(booking.getState()){
					case 'remplir':
						console.debug("remplir");	
						if(booking.isAllDispo()) {
							mainAction = BookingModel.actions.valid.key;
							mainActionColor = BookingModel.actions.valid.color;
							mainActionIcon = BookingModel.actions.valid.icon;
							mainActionDisabled = '';
						}
						else {
							mainAction = BookingModel.actions.resolve_conflict.key;
							mainActionColor = BookingModel.actions.resolve_conflict.color;
							mainActionIcon = BookingModel.actions.resolve_conflict.icon;
							mainActionDisabled = '';
						}
					break;
					case 'cancel':	
							console.debug("cancel");	
							mainAction = BookingModel.actions.refused.key;
							mainActionColor = BookingModel.actions.refused.color;
							mainActionIcon = BookingModel.actions.refused.icon;
							mainActionDisabled = '';
					break;
					case 'confirm':	
							mainAction = BookingModel.actions.closed.key;
							mainActionColor = BookingModel.actions.closed.color;
							mainActionIcon = BookingModel.actions.closed.icon;
							mainActionDisabled = '';
					break;
					
					default:
							mainAction = BookingModel.actions.valid.key;
							mainActionColor = BookingModel.actions.valid.color;
							mainActionIcon = BookingModel.actions.valid.icon;
							mainActionDisabled = '';
				}

			%>
			<!-- Main action button -->
			<button class="btn btn-<%= mainActionColor %> <%= mainActionDisabled %> no-outline button<%= _.capitalize(mainAction) %>Booking" >
				<i class="fa <%= mainActionIcon %> fa-fw button<%= _.capitalize(mainAction) %>Booking"></i>
			</button>
			
			<!-- Dropdown button action -->
			<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">
				<span class="fa fa-caret-down"></span>
			</button>
			
			<!-- Other buttons action -->
			<ul class="dropdown-menu pull-right text-left">
				<% _.each(actions, function(action){ %>
					<li>
						<a href="#reservations" class="button<%= _.capitalize(app.Models.Booking.actions[action].key) %>Booking">
							<i class="fa <%= app.Models.Booking.actions[action].icon %> fa-fw"></i>&nbsp;<%= _.capitalize(app.Models.Booking.actions[action].translation) %>
						</a>
					</li>
				<% }); %>
			</ul>
		</div>
	<% } %>
</td>
